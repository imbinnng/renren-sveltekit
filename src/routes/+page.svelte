<script lang="ts">
  import FeedList from '../lib/components/FeedList.svelte';
  import FeedDetail from '../lib/components/FeedDetail.svelte';
  import StatusComposer from '../lib/components/StatusComposer.svelte';
  import Avatar from '../lib/components/ui/avatar/avatar.svelte';
  import AvatarImage from '../lib/components/ui/avatar/avatar-image.svelte';
  import AvatarFallback from '../lib/components/ui/avatar/avatar-fallback.svelte';
  import Button from '../lib/components/ui/button/button.svelte';
  import Card from '../lib/components/ui/card/card.svelte';
  import CardContent from '../lib/components/ui/card/card-content.svelte';

  let selectedFeed: any = null;
  let showDetail = false;

  function openFeed(feed: any) {
    selectedFeed = feed;
    showDetail = true;
  }

  function closeDetail() {
    showDetail = false;
    selectedFeed = null;
  }

  function refreshFeed() {
    console.log('Refreshing feed');
  }
</script>

{#if showDetail && selectedFeed}
  <div class="p-4">
    <button on:click={closeDetail} class="text-blue-600 hover:text-blue-800 text-sm mb-4">
      â† è¿”å›é¦–é¡µ
    </button>
    <div class="max-w-2xl">
      <FeedDetail feed={selectedFeed} />
    </div>
  </div>
{:else}
  <div class="max-w-6xl mx-auto p-4">
    <div class="flex gap-6">
      <div class="w-64 hidden lg:block">
        <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4">
          <nav class="space-y-1">
            <button class="w-full text-left px-3 py-2 rounded flex items-center space-x-2" style="background-color: var(--renren-blue); color: white;">
              <span>ğŸ </span>
              <span>é¦–é¡µ</span>
            </button>
            <a href="/friends" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100 flex items-center space-x-2 block">
              <span>ğŸ‘¥</span>
              <span>å¥½å‹</span>
            </a>
            <a href="/albums" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100 flex items-center space-x-2 block">
              <span>ğŸ“·</span>
              <span>ç›¸å†Œ</span>
            </a>
            <a href="/blogs" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100 flex items-center space-x-2 block">
              <span>ğŸ“</span>
              <span>æ—¥å¿—</span>
            </a>
            <a href="/share" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100 flex items-center space-x-2 block">
              <span>ğŸ”„</span>
              <span>åˆ†äº«</span>
            </a>
          </nav>
        </div>

        <div class="bg-white rounded-lg border border-gray-200 p-4">
          <h3 class="font-bold mb-3">åº”ç”¨</h3>
          <div class="grid grid-cols-2 gap-2">
            <button class="text-xs p-2 h-auto bg-white border border-gray-200 rounded hover:bg-gray-50">ğŸš— æŠ¢è½¦ä½</button>
            <button class="text-xs p-2 h-auto bg-white border border-gray-200 rounded hover:bg-gray-50">ğŸ’° æœ‹å‹ä¹°å–</button>
            <button class="text-xs p-2 h-auto bg-white border border-gray-200 rounded hover:bg-gray-50">ğŸŒ¾ å¤©å¤©å†œåœº</button>
            <button class="text-xs p-2 h-auto bg-white border border-gray-200 rounded hover:bg-gray-50">ğŸ„ é˜³å…‰ç‰§åœº</button>
          </div>
        </div>
      </div>

      <div class="flex-1">
        <div class="space-y-6">
          <div class="bg-white rounded-lg border border-gray-200 p-6">
            <h2 class="text-lg font-semibold mb-4">åˆ†äº«ä½ çš„æ–°é²œäº‹...</h2>
            <StatusComposer on:refresh={refreshFeed} />
          </div>
          <div class="bg-white rounded-lg border border-gray-200 p-6">
            <FeedList {openFeed} />
          </div>
        </div>
      </div>

      <div class="w-64 hidden xl:block">
        <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4">
          <h3 class="font-bold">çƒ­é—¨åº”ç”¨</h3>
          <div class="space-y-2">
            <a href="/albums" class="block text-sm hover:underline text-blue-600">æŠ¢è½¦ä½</a>
            <a href="/" class="block text-sm hover:underline text-blue-600">æœ‹å‹ä¹°å–</a>
            <a href="/" class="block text-sm hover:underline text-blue-600">å¤©å¤©å†œåœº</a>
            <a href="/" class="block text-sm hover:underline text-blue-600">é˜³å…‰ç‰§åœº</a>
          </div>
        </div>

        <div class="bg-white rounded-lg border border-gray-200 p-4">
          <h3 class="font-bold mb-3">å¯èƒ½è®¤è¯†çš„äºº</h3>
          <div class="space-y-3">
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold">ç‹</div>
              <div class="flex-1">
                <div class="text-sm font-medium">ç‹å°æ˜</div>
                <div class="text-xs text-gray-500">5ä¸ªå…±åŒå¥½å‹</div>
              </div>
              <Button size="sm" class="bg-blue-600 hover:bg-blue-700 text-white">åŠ å¥½å‹</Button>
            </div>
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold">æ</div>
              <div class="flex-1">
                <div class="text-sm font-medium">æç¾ä¸½</div>
                <div class="text-xs text-gray-500">3ä¸ªå…±åŒå¥½å‹</div>
              </div>
              <Button size="sm" class="bg-blue-600 hover:bg-blue-700 text-white">åŠ å¥½å‹</Button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
{/if}